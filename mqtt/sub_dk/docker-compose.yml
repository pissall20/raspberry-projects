version: "3"
services:
    timescaledb:
        container_name: timescaledb
        image: timescale/timescaledb
        ports:
            - "5432:5432"
    mqtt-broker:
        container_name: mqtt-broker-sub
        image: emqx/emqx
        ports:
            - "1883:1883"
    subscriber:
        depends_on: 
            - timescaledb
            - mqtt-broker
        container_name: subscriber
        restart: always
        build: 
            dockerfile: Dockerfile
            context: .
        command: python /app/subscriber.py
        links:
            - timescaledb
            - mqtt-broker-sub
